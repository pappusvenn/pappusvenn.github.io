<!DOCTYPE html>
<html>
 
<head>
  <meta charset="utf-8">
  <title>TrueCost Flight Search</title>
  <link href="http://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
  <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

  <!-- Javascript to establish the datepicker -->
  <script>
     $(function() {
        $( "#datepicker-1" ).datepicker();
     });
  </script>
</head>
 
<body>
 <h1> TrueCost Flight Search</h1>
 <p>Origin Address (Street, City, State): <input type="text" id="originadd"></p>
 <p>Destination Address (Street, City, State): <input type="text" id="destadd"></p>
 <p>Enter Date: <input type="text" id="datepicker-1"></p>
 <input type="button" id="compare-flights" value="Search">
 <div id="supercool"></div>
 
  <script>
    document.getElementById('compare-flights').addEventListener('click',function(){
         searchandcompare();
    });
    
var aerorportos = {}; //CLEARLY IT IS FUCKING DEFINED!!!!!!!!
    
function loadjson() {
  var xobj = new XMLHttpRequest();
  xobj.overrideMimeType("application/json");
  xobj.open('GET', 'airports.json', false); 
  var aeroportos = {};
  xobj.onreadystatechange = function () {
  if (xobj.readyState == 4 && xobj.status == "200") {
    aeroportos = JSON.parse(loadairports(xobj.responseText));}
  };
    xobj.send(null);
    return aeroportos;
}
    //function loadairports(response) {
      // aeroportos = JSON.parse(response); //It was already defined earlier!!!
    //}
    

    
    function searchandcompare(){
    
    var str = JSON.stringify(loadjson()); //But Javascript says this is undefined now. What the FUCKINg FUCK
    console.log(str);
    //'var xhr = new XMLHttpRequest();
    //'var url = "https://www.googleapis.com/qpxExpress/v1/trips/search?key=AIzaSyBDPcpkXlwpVY7G4yr0v_sshszmUKmASP4";
    
    //'xhr.onreadystatechange=function() {
    //'if (this.readyState == 4 && this.status == 200) {
     //   'myFunction(this.responseText);
    //''}
     //''}
    
    // 'xhr.open('POST', url, true);
     //'xhr.setRequestHeader("Content-Type", "application/json");
     //'xhr.send('{"request": {"slice": [{"origin": "DFW","destination": "SFO","date": "2016-09-23"}],"passengers": {"adultCount": 1,"infantInLapCount": 0,"infantInSeatCount": 0,"childCount": 0,"seniorCount": 0},"solutions": 20,"refundable": false}}');
     

    //'function myFunction(response) {
     //var arr = JSON.parse(response);
     //var i;
     //var out = response;

     
    }  
      
  </script>
  
  
</body>
 
</html>
